# socket之send和recv原理剖析

#### 1. 认识TCP socket的发送和接收缓冲区 <a id="1-&#x8BA4;&#x8BC6;tcp-socket&#x7684;&#x53D1;&#x9001;&#x548C;&#x63A5;&#x6536;&#x7F13;&#x51B2;&#x533A;"></a>

当创建一个TCP socket对象的时候会有一个**发送缓冲区**和一个**接收缓冲区**，**这个发送和接收缓冲区指的就是内存中的一片空间。**

#### 2. send原理剖析 <a id="2-send&#x539F;&#x7406;&#x5256;&#x6790;"></a>

send是不是直接把数据发给服务端?

不是，要想发数据，必须得**通过网卡发送数据**，应用程序是无法直接通过网卡发送数据的，它需要调用操作系统接口，也就是说，应用程序把发送的数据先写入到**发送缓冲区**\(内存中的一片空间\)，再**由操作系统控制网卡把发送缓冲区的数据发送给服务端网卡** 。

#### 3. recv原理剖析 <a id="3-recv&#x539F;&#x7406;&#x5256;&#x6790;"></a>

recv是不是直接从客户端接收数据?

不是，**应用软件是无法直接通过网卡接收数据的**，它需要调用操作系统接口，**由操作系统通过网卡接收数据**，把接收的数据**写入到接收缓冲区**\(内存中的一片空间），应用程序**再从接收缓存区获取客户端发送的数据**。

#### 4. send和recv原理剖析图 <a id="4-send&#x548C;recv&#x539F;&#x7406;&#x5256;&#x6790;&#x56FE;"></a>

![send&#x548C;recv&#x539F;&#x7406;&#x5256;&#x6790;&#x56FE;](../../../.gitbook/assets/image%20%2858%29.png)

**说明:**

* 发送数据是发送到发送缓冲区
* 接收数据是从接收缓冲区获取

#### 5. 小结 <a id="5-&#x5C0F;&#x7ED3;"></a>

不管是recv还是send都不是直接接收到对方的数据和发送数据到对方，**发送数据会写入到发送缓冲区，接收数据是从接收缓冲区来读取，发送数据和接收数据最终是由操作系统控制网卡来完成。**

